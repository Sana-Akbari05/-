# جلسه پنجم ریزپردازنده و زبان اسمبلی
# ثناء اکبری
# سون سگمنت ، فوتوسل و اسپیکر
**7segment**
این مدار دارای ماژول سون سگمنت است که میتوان به صورت آنالوگ اعداد 0 تا 9 یا بعضی از حروف انگلیسی را نمایش داد
این ماژول دارای 7 قسمت است به ترتیب ساعتگرد از بالا A   تا F و قسمت وسط G است .
برای روشن کردن هر قسمت باید مقدار آن را در کد 1 و برای خاموش شدن میزان آن را 0 دهیم
به این علت که یک ماژول مشخص است مقدار را به صورت ستونی مینویسیم تا با  تنظیم قسمت ها شکل ، عدد یا حروف مشخص را به ما نمایش دهد.
تمام اعدادی که نیاز داریم که ببینیم را درون یک تابع تعریف میکنیم که شامل 7 مقدار است که از ترتیب چپ به راست (از A تا G)است .
هر سطر شامل یک عدد میشود و برای نمایش اعداد از 0 تا 9 تابع ما شامل 10 سطر و 7 ستون میشود.
برای خواندن تابع و اجرای آن از خروجی ها حلقه ای تریف میکنیم که به ترتیب از 0 تا 7 را مشمارد و با عدد یک جمع میزند تا بتواند مقدار آن را آز ورودی دریافت کند.
سپس حلقه دیگری تعریف کرده تا بتواند از 0 تا 9 را به صورت تک به تک روی ماژول نمایش دهد.
مشاهده شماتیک:
![7_segment](https://github.com/user-attachments/assets/c157291c-3fa4-4d9c-8637-fc4169c49cba)

مشاهده کد:

مشاهده خروجی:


https://github.com/user-attachments/assets/7aafc8d2-855f-4842-a5e9-9dee81b0d358



**7 segment alphabet**

این مدار همانند مدار قبلی است که با این تفاوت که در تابع تعریف شده به جای اعداد جروف A , C, E, F, H, L, Pنمایش داده شود
برای این کار فقط نیاز است که برای تعداد ستون ها به تعداد تعریف شده در هر قسمت از ماژول میزان مناسب را اختصاص دهیم.
برای مثال برای حرف A نیاز است که قسمت های a, b, c, e, f, g دارای مقدار 1 باشند و قسمت d دارایی مقدار 0.
که در تابع بدین شکل خواهد شد:
{1,1,1,0,1,1,1}
و در تغییر آخر باید حلقه آخرکه در خواندن تعداد سطر های ماتریس نقش دارد از 0 تا 7 تغییر دهیم.
مشاهده شماتیک:
![7_segment](https://github.com/user-attachments/assets/d6f6a9b1-ea5b-4823-bcd7-83c357c033fc)
مشاهده کد:

مشاهده خروجی:


https://github.com/user-attachments/assets/f35e0361-d255-450a-a330-e52d4a83f0b6



**Photocell**
فتوسل ماژولی است که برای تشخیص میزان روشنایی استفاده میشود.
بازه روشنایی این ماژول از 0 تا 1023 است که در این کد میزان روشنایی درون سریال مانیتور نمایش داده شده است.
برای این کار باید مقدار ورودی ماژول را از A0 گرفته و با تعریف کردن بادرید 9600 درون سریال مانیتور مقدار آن را مشاهده کرد.
در این کد تعریف شده است که اگر میزان روشنایی از مقدار 800 پایین تر آمد ، لامپ ال ای دی روشن شود و در صورتی که روشنایی محیط به اندازه کافی بود ال ای دی خاموش شود.

مشاهده شماتیک:
![photocell](https://github.com/user-attachments/assets/2204e123-d9cc-456d-b0c1-60e3d1e19a20)
مشاهده کد:

مشاهده خروجی:


https://github.com/user-attachments/assets/a2f4d815-7926-41ff-9b7d-67b55b118782


**Fade photocell**
این کد همانند کد قبلی است با این تفاوت که میزان روشنایی لامپ بر اساس میزان تاریکی کم  زیاد میشود و هرچع فضا تاریک تر شود و شدت روشنایی آن کمتر شود، میزان روشنایی لامپ بیشتر میشود .
در این کد لامپ همواره روشن است و به هیچ عنوان خاموش نمیشود
برای تبدیل روشنایی فتوسل به میزان روشنایی لامپ باید از دستور مپ استفاده کرد وطوری تعیین شود که هرچه میزان روشنایی محیط بیشتر میشود میزان روشنایی لامپ کمتر شود؛ درواقع باید بیشترین میزان فتوسل که 1023 است ، تبدیل به کمترین میزان روشنایی لامپ که 0 است شود و برعکس .
دستور بدین صورت است:
map(sensor, 0, 1023, 255, 0);
بعد از تبدیل این دستور را درون مقداری معین ریخته و به ال ای دی میدهیم .

مشاهده شماتیک:
![photocell](https://github.com/user-attachments/assets/346b7337-f7be-4658-be0a-8115068841a5)

مشاهده کد:

مشاهده خروجی:


https://github.com/user-attachments/assets/5178351e-8a55-4e91-bcef-93416c773dcd



**Limited fade photocell**
مشکل دستور قبلی این بود که لامپ همواره روشن بود و در هیچ مقداری به صورت کامل خاموش نمیشد.
در این کد با کوتاه کردن بازه تبدیل مقدار و گذاشتن شرط مربوط به خاموش شدن کامل بعد از تمام شدن بازه میتوان در صورت روشنایی کافی محیط لامپ را خاموش دید و در صورت بیشتر شدن تدریجی میزان تاریکی محیط، روشنایی تدریجی درون لامپ مشاهده کرد.

مشاهده شماتیک:
![photocell](https://github.com/user-attachments/assets/e0c5aade-a24c-4e3f-8cb0-d301e9092895)

مشاهده کد:

مشاهده خروجی:


https://github.com/user-attachments/assets/03d74942-e719-47a7-be90-a8eb62b05322



**Speaker** 
از اسپیکر برای تبدیل کردن نوت ها ، نوسانات و امواج مغناطیسی به امواج صوتی استفاده میشود
در این مدار هدف ساختن یک زنگ آهنگ برای موبایل است.برای این کار ورودی اسپیگر را از ورودی های دیجیتال PMWگرفته و سر دیگر آن را به زمین متصل میکنیم.
برای تعریف نوت ها باید ابتدا کتابخانه مربوط به نوت هارا  تعریف کنیم ؛ برای این کار باید ctrl+Shitf+N را گرفته و فایل مورد نظر را با پسوند .h ایجاد و ذخیره کنیم .
در این کتابخانه انواع نوت های موسیقی ذخیره میشود.
سپس درون برنامه تابعی تعریف میکنیم که شامل نوت های مد نظر برای زنگ آهنگ میشود.
و درون تابعی دیگر مدت زمان بخش هر نوت را.
تابعی به نام mobile  تعریف کرده و ابتدا حلقه ای به تعداد نوت های خواسته شده که در اینجا 10 است تعریف میکنیم به و ردون آن متغیری تریف میکنیم که مدت زمان اجرای هر نوت به میلی ثانیه تبدیل و درون  خود ذخیره کند.
با دستور tone که برای نواختن نوت است استفاده میشود تا همزمان از ورودی که 9 است هم نوت پیدا شود و به مدت زمان تبدیل شده بخش شود.
بعد از متغییری تعیین میشود که میزان تبدیل شده به میلی ثانیه را در1.43 ضرب کند و همان را تبدیل به مکث میان نوت ها کند.
بدین صورت زنگ آهنگ با هر فشار کلید پخش خواهد شد.
مشاهده شماتیک:
![speaker](https://github.com/user-attachments/assets/490b2408-a4f6-42b6-bab6-b7e4fbf5af19)

مشاهده کد:

مشاهده خروجی:



https://github.com/user-attachments/assets/d2db5e07-da20-465a-94ad-fcff63f91b40

